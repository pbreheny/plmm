<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="plmm">
<title>Getting started with plmm • plmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with plmm">
<meta property="og:description" content="plmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">plmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A-plink-files.html">Processing PLINK files</a>
    <a class="dropdown-item" href="../articles/B-choose_k.html">Choosing k -- an eigenproblem</a>
    <a class="dropdown-item" href="../articles/C-explore_options.html">Exploring different modeling options</a>
    <a class="dropdown-item" href="../articles/D-deconfounding.html">Deconfounding</a>
    <a class="dropdown-item" href="../articles/E-mfdr.html">Inference with marginal false discovery rates</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with plmm</a>
    <a class="dropdown-item" href="../articles/notation.html">Notes on notation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started with plmm</h1>
                        <h4 data-toc-skip class="author">Tabitha
Peter</h4>
            
      
      
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plmm</span><span class="op">)</span></span></code></pre></div>
<p><strong>NOTE</strong>: This vignette is under development – not all
of the examples here are fully worked through. My work here is an
example of <a href="https://notes.andymatuschak.org/About_these_notes?stackedNotes=z21cgR9K3UcQ5a7yPsj2RUim3oM2TzdBByZu" class="external-link">working
with the garage door open</a>.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>plmm</code> is an <code>R</code> package created for the
purpose of fitting penalized regression models to high dimensional data,
particularly that in which the observations are not independent. This
kind of data arises often in the context of genetics (<em>e.g.</em> GWAS
dealing with population structure), and this will be the motivation for
the examples presented here.</p>
<p>At this time, the package is designed for linear regression only –
that is, we are considering only continuous (numeric) outcomes. In the
future, I would like to extend this package to handle logistic
regression (to handle dichotomous outcomes).</p>
<p>Since we are focused on penalized regression in this package,
<code>plmm</code> offers 3 choices of penalty: the minimax concave
(MCP), the smoothly clipped absolute deviation (SCAD), and the least
absolute shrinkage and selection operator (LASSO). Much of the work in
this package is built on the concepts/techniques provided in the
<code>ncvreg</code> <a href="https://github.com/pbreheny/ncvreg" class="external-link">package</a>, whose author is
<a href="https://myweb.uiowa.edu/pbreheny/" class="external-link">my dissertation
advisor</a>.</p>
<p><code>plmm</code> currently includes two example data sets:</p>
<ul>
<li><p><code>admix</code> is a small data set (197 observations, 100
SNPs) that describes individuals of different racial backgrounds. The
outcome of <code>admix</code> is simulated to include population
structure effects (<em>i.e.</em> race/ethnicity have an impact on the
SNP associations).</p></li>
<li><p><code>penncath_lite</code> (data on coronary artery disease from
the <a href="https://pubmed.ncbi.nlm.nih.gov/21239051/" class="external-link">PennCath
study</a>) is a mid-sized, high dimensional data set (1401 observations,
4217 SNPs) with several health outcomes as well as age and sex
information. This data set is a subset of a much larger data set (the
original data has over 800K SNPs). For for information on this data set,
refer to the <a href="https://pubmed.ncbi.nlm.nih.gov/21239051/" class="external-link">original
publication</a>.</p></li>
</ul>
<p>In this overview, I will provide a demo of the main functions in
<code>plmm</code> using the <code>admix</code> data. Checkout the
‘Working with PLINK files’ vignette to see a demo of processing the
<code>penncath_lite</code> data from the original PLINK file
formats.</p>
</div>
<div class="section level2">
<h2 id="basic-model-fitting">Basic model fitting<a class="anchor" aria-label="anchor" href="#basic-model-fitting"></a>
</h2>
<p>The <code>admix</code> data is already formatted to have elements
<span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span>, so I can jump right in with a call to
<code>plmm</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">admix_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plmm.html">plmm</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">X</span>, y <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">admix_fit</span>, lambda <span class="op">=</span> <span class="va">admix_fit</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">95</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; MCP-penalized regression model with n=, p=101 at lambda=0.0349</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; The model converged </span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; # of non-zero coefficients:  80 </span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span></code></pre></div>
<p>The returned <code>beta_vals</code> item is a matrix whose rows are
<span class="math inline">\(\beta\)</span> coefficients and whose
columns represent values of the penalization parameter <span class="math inline">\(\lambda\)</span>. By default, <code>plmm</code>
fits 100 values of <span class="math inline">\(\lambda\)</span> (see the
<code>setup_lambda</code> function for details).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">admix_fit</span><span class="op">$</span><span class="va">beta_vals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">97</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span><span class="co">#&gt;                    0.0328        0.0319        0.0309        0.0300</span></span>
<span><span class="co">#&gt; (Intercept) -3.646252e+14 -3.641797e+14 -3.635221e+14 -3.606863e+14</span></span>
<span><span class="co">#&gt; Snp1        -4.569951e-01 -4.578702e-01 -4.588573e-01 -4.620568e-01</span></span>
<span><span class="co">#&gt; Snp2         1.290528e-01  1.339690e-01  1.387797e-01  1.441289e-01</span></span>
<span><span class="co">#&gt; Snp3         5.664828e+00  5.663927e+00  5.662990e+00  5.646975e+00</span></span>
<span><span class="co">#&gt; Snp4         4.066041e-01  4.062007e-01  4.055993e-01  4.037997e-01</span></span>
<span><span class="co">#&gt; Snp5        -9.689787e-01 -9.721192e-01 -9.753301e-01 -9.680589e-01</span></span>
<span><span class="co">#&gt; Snp6        -6.066207e-02 -6.244764e-02 -6.436125e-02 -6.626384e-02</span></span>
<span><span class="co">#&gt; Snp7         1.126228e-01  1.174248e-01  1.220051e-01  1.265012e-01</span></span>
<span><span class="co">#&gt; Snp8         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span></span>
<span><span class="co">#&gt; Snp9         8.803933e-01  8.810233e-01  8.813319e-01  8.776630e-01</span></span></code></pre></div>
<p>Note that for all values of <span class="math inline">\(\lambda\)</span>, SNP 8 has <span class="math inline">\(\hat \beta = 0\)</span>. This is because SNP 8 is
a constant feature, a feature (column) whose values do not vary among
the members of this population.</p>
<p>We can summarize our fit at the nth <span class="math inline">\(\lambda\)</span> value:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for n = 25 </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">admix_fit</span>, lambda <span class="op">=</span> <span class="va">admix_fit</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; MCP-penalized regression model with n=, p=101 at lambda=0.2901</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; The model converged </span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; # of non-zero coefficients:  9 </span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span></code></pre></div>
<p>We can also plot the path of the fit to see how model coefficients
vary with <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">admix_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/admix_plots-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="cross-validation">Cross validation<a class="anchor" aria-label="anchor" href="#cross-validation"></a>
</h2>
<p>To select a <span class="math inline">\(\lambda\)</span> value, we
often use cross validation. Below is an example of using
<code>cv.plmm</code> to select a <span class="math inline">\(\lambda\)</span> that minimizes cross-validation
error:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">admix_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.plmm.html">cv.plmm</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">X</span>, y <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">admix_cv_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">admix_cv</span>, lambda <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">admix_cv_s</span><span class="op">)</span></span>
<span><span class="co">#&gt; MCP-penalized model with n=197 and p=100</span></span>
<span><span class="co">#&gt; At minimum cross-validation error (lambda=0.1491):</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt;   Nonzero coefficients: 28</span></span>
<span><span class="co">#&gt;   Cross-validation error (deviance): 3.18</span></span>
<span><span class="co">#&gt;   Scale estimate (sigma): 1.784</span></span></code></pre></div>
<p>We can also plot the cross-validation error (CVE) versus <span class="math inline">\(\lambda\)</span> (on the log scale):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">admix_cv</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="predicted-values">Predicted values<a class="anchor" aria-label="anchor" href="#predicted-values"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> methods for PLMMs are in development (we
are working on a Best Linear Unbiased Predictor); below is an example of
where we are for now:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make predictions for select lambda value(s)</span></span>
<span><span class="va">admix_pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">admix_fit</span>,</span>
<span>                       newX <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"lp"</span>,</span>
<span>                       idx<span class="op">=</span><span class="fl">98</span><span class="op">)</span></span></code></pre></div>
<p>More to come….</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Anna C. Reisetter, Patrick J. Breheny, Tabitha K. Peter, Yujiing Lu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
